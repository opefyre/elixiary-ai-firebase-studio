/* Mobile PWA Fixes - iOS Safe Area and Viewport Handling */

/* Global safe area CSS variables */
:root {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

/* Paint behind the status bar on iOS - Critical fix from web.dev article */
body::before {
  content: "";
  position: fixed;
  top: 0; 
  left: 0; 
  right: 0;
  height: var(--safe-top);
  background: hsl(var(--background));
  pointer-events: none;
  z-index: 49; /* Just below navbar */
}

/* Mobile PWA Layout - Bottom Navigation Design */
@media screen and (max-width: 768px) {
  /* Mobile header - simple top bar */
  .mobile-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 40;
    /* Give header safe padding at the top */
    padding-top: max(12px, var(--safe-top));
    /* Ensure header extends to edges */
    margin: 0;
  }
  
  /* Bottom navigation - native app style */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 50;
    /* Give bottom nav safe padding at the bottom */
    padding-bottom: max(8px, var(--safe-bottom));
    /* Ensure bottom nav extends to edges */
    margin: 0;
  }
  
  /* Add padding to body to account for fixed header and bottom nav */
  .mobile-body-padding {
    padding-top: calc(4rem + max(12px, var(--safe-top)));
    padding-bottom: calc(5rem + max(8px, var(--safe-bottom)));
  }
  
  /* Fix for content appearing above elements when scrolling */
  .mobile-content-container {
    position: relative;
    z-index: 1;
  }
}

/* iOS PWA specific fixes */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari specific styles */
  .ios-pwa-fix {
    /* Prevent content from appearing behind status bar */
    padding-top: var(--safe-top);
  }
  
  /* Fix for iOS viewport height issues */
  .ios-viewport-fix {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }
  
  /* Fix for iOS scroll bounce */
  .ios-scroll-fix {
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
  }
}

/* Android PWA fixes */
@media screen and (max-width: 768px) and (min-resolution: 2dppx) {
  .android-pwa-fix {
    /* Android specific PWA fixes */
    -webkit-tap-highlight-color: transparent;
  }
}

/* General mobile PWA improvements */
@media screen and (max-width: 768px) {
  /* Prevent zoom on input focus */
  input, textarea, select {
    font-size: 16px;
  }
  
  /* Improve touch targets */
  button, a, [role="button"] {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Fix for mobile viewport units */
  .mobile-vh-fix {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
  }
}