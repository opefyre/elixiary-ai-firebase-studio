/* Mobile PWA Fixes - iOS Safe Area and Viewport Handling */

/* Global safe area CSS variables */
:root {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

/* CRITICAL: Apply safe area padding to body for iOS PWA */
/* Only apply on mobile devices to avoid desktop issues */
@media screen and (max-width: 768px) {
  body {
    /* Only apply side and bottom padding, top is handled by navbar */
    padding-right: var(--safe-right);
    padding-bottom: var(--safe-bottom);
    padding-left: var(--safe-left);
  }
}

/* Fake navbar section behind status bar - BIG negative offset! */
body::before {
  content: "";
  position: fixed;
  top: calc(-1 * var(--safe-top) * 3); /* BIG negative offset - 3x for massive coverage */
  left: 0; 
  right: 0;
  height: calc(var(--safe-top) * 3 + 4rem); /* BIG height to cover massive area above */
  background: hsl(var(--background) / 0.8); /* Same as navbar */
  backdrop-filter: blur(12px); /* Same as navbar */
  border-bottom: 1px solid hsl(var(--border)); /* Same as navbar */
  pointer-events: none;
  z-index: 49; /* Just below real navbar */
}

/* Fix for iOS PWA navbar positioning - Based on web.dev article */
@media screen and (max-width: 768px) {
  /* Navbar with proper safe area handling - ORIGINAL SIZE */
  .mobile-navbar-fix {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
    /* NO safe area padding - keep original size */
    padding-top: 0;
    margin: 0;
  }
  
  /* Add padding to body to account for fixed navbar - ORIGINAL SIZE */
  .mobile-body-padding {
    padding-top: 4rem; /* Only navbar height, no safe area padding */
  }
  
  /* Fix for content appearing above navbar when scrolling */
  .mobile-content-container {
    position: relative;
    z-index: 1;
  }
}

/* iOS PWA specific fixes */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari specific styles */
  .ios-pwa-fix {
    /* Prevent content from appearing behind status bar */
    padding-top: var(--safe-top);
  }
  
  /* Fix for iOS viewport height issues */
  .ios-viewport-fix {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }
  
  /* Fix for iOS scroll bounce */
  .ios-scroll-fix {
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
  }
  
  /* iOS PWA specific - MASSIVE fake navbar coverage */
  .ios-pwa body::before {
    /* MASSIVE height and offset for complete status bar coverage */
    height: calc(max(var(--safe-top), 44px) * 4 + 4rem) !important;
    top: calc(-1 * max(var(--safe-top), 44px) * 4) !important;
    /* Ensure it covers the entire status bar area and more */
    background: hsl(var(--background) / 0.9) !important;
    backdrop-filter: blur(16px) !important;
  }
}

/* Android PWA fixes */
@media screen and (max-width: 768px) and (min-resolution: 2dppx) {
  .android-pwa-fix {
    /* Android specific PWA fixes */
    -webkit-tap-highlight-color: transparent;
  }
}

/* General mobile PWA improvements */
@media screen and (max-width: 768px) {
  /* Prevent zoom on input focus */
  input, textarea, select {
    font-size: 16px;
  }
  
  /* Improve touch targets */
  button, a, [role="button"] {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Fix for mobile viewport units */
  .mobile-vh-fix {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
  }
}